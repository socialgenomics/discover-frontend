<div class="col s12 m4 l4">
  <div class="card dataset">
    {{#if (eq type "request")}}
      <div class="card-header">
        <div class="assay-container">
          <div class="request">Request</div>
        </div>
        <div class="actions-container valign-wrapper">
          {{action-favourite model=dataset}}
          {{action-share action="toggleModal" dataset=dataset}}
        </div>
      </div>

      <div class="card-body">
        {{#if dataset.highlights.title}}
          {{#link-to 'requests.detail' dataset.id classNames="data-title"}}
            <div data-balloon={{dataset.title}} data-balloon-pos="up" data-balloon-length="large">
              <h4 class="data-title">{{{truncate dataset.highlights.title 70}}}</h4>
            </div>
          {{/link-to}}
        {{else}}
          {{#link-to 'requests.detail' dataset.id classNames="data-title"}}
            <div data-balloon={{dataset.title}} data-balloon-pos="up" data-balloon-length="large">
              <h4 class="data-title">{{truncate dataset.title 70}}</h4>
            </div>
          {{/link-to}}
        {{/if}}

        {{from-label model=dataset searchRoute=searchRoute isRequest=true}}

        <div class="line-limit-desc">
          <div class="ellipsis sub-grey markdown-text">
            {{#if dataset.highlights.description}}
              {{{markdown-to-html markdown=dataset.highlights.description}}}
            {{else}}
              {{markdown-to-html markdown=dataset.description}}
            {{/if}}
          </div>
        </div>
      </div>
      <div class="card-footer">
        {{stats-list stats=dataset.stats}}
      </div>

    {{else}} <!-- It is a Dataset -->

      <div class="card-header">
        {{#if dataset.assay}}
          <div class="assay-container">
            <!-- HACK #380 -->
            {{#if searchRoute}}
              {{#link-to 'datasets.search' (query-params assay=dataset.assay) }}
                <div class="assay-container" data-balloon={{dataset.assay}} data-balloon-pos="up">
                  <span class="assay-small {{dataset.colour}}"></span>
                </div>
              {{/link-to}}
            {{else}}
              {{#link-to 'datasets.search' (query-params q="" assay=dataset.assay) }}
                <div class="assay-container" data-balloon={{dataset.assay}} data-balloon-pos="up">
                  <span class="assay-small {{dataset.colour}}"></span>
                </div>
              {{/link-to}}
            {{/if}}

          </div>
        {{/if}}
        <div class="actions-container valign-wrapper">
          {{action-favourite model=dataset}}
          {{action-share action="toggleModal" dataset=dataset}}
        </div>
      </div>
      <div class="card-body">
        {{#if dataset.highlights.title}}
          {{#link-to 'datasets.detail' dataset.id classNames="data-title"}}
            <div data-balloon={{dataset.title}} data-balloon-pos="up" data-balloon-length="large">
              <h4 class="data-title">{{{truncate dataset.highlights.title 70}}}</h4>
            </div>
          {{/link-to}}
        {{else}}
          {{#link-to 'datasets.detail' dataset.id classNames="data-title"}}
            <div data-balloon={{dataset.title}} data-balloon-pos="up" data-balloon-length="large">
              <h4 class="data-title">{{truncate dataset.title 70}}</h4>
            </div>
          {{/link-to}}
        {{/if}}
        {{from-label model=dataset searchRoute=searchRoute}}
        <div class="line-limit-desc">
          <div class="ellipsis sub-grey markdown-text">
            {{#if dataset.highlights.description}}
              {{{markdown-to-html markdown=dataset.highlights.description}}}
            {{else}}
              {{markdown-to-html markdown=dataset.description}}
            {{/if}}
          </div>
        </div>
      </div>
      <div class="card-footer">
        {{stats-list stats=dataset.stats access=dataset.access}}
      </div>
    {{/if}}
  </div>
</div>
